<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ”¥ Ultimate Social App</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>

<style>
body { font-family: Arial; padding: 20px; }
.card { background:#f2f2f2; padding:15px; margin:15px 0; border-radius:10px; }
button { padding:6px 10px; margin:5px 0; cursor:pointer; }
input { padding:6px; }
</style>
</head>

<body>

<h2>ðŸ”¥ Ultimate Social App</h2>

<div id="authSection">
  <button id="googleBtn">Login with Google</button>
  <button id="guestBtn">Guest Login</button>
</div>

<div id="appSection" style="display:none;">
  <p id="userInfo"></p>
  <button id="logoutBtn">Logout</button>

  <br><br>

  <input id="postInput" placeholder="Write something..." />
  <button id="postBtn">Post</button>

  <div id="feed"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

  console.log("DOM Loaded");

  const { createClient } = window.supabase;

  const supabase = createClient(
    "https://dgehzagvyrxbnnvgsiff.supabase.co",
    "sb_publishable_0zcUZcMnYsVKrX0rhxA9Eg_6GwlyzKW"
  );

  console.log("Supabase Ready");

  const googleBtn = document.getElementById("googleBtn");
  const guestBtn = document.getElementById("guestBtn");
  const logoutBtn = document.getElementById("logoutBtn");
  const postBtn = document.getElementById("postBtn");

  // ---------------- LOGIN ----------------

  googleBtn.addEventListener("click", async function () {
    console.log("Google Clicked");
    await supabase.auth.signInWithOAuth({
      provider: "google",
      options: {
        redirectTo: window.location.origin
      }
    });
  });

  guestBtn.addEventListener("click", async function () {
    console.log("Guest Clicked");
    await supabase.auth.signInAnonymously();
  });

  logoutBtn.addEventListener("click", async function () {
    await supabase.auth.signOut();
    location.reload();
  });

  // ---------------- CHECK USER ----------------

  async function checkUser() {
    const { data: { user } } = await supabase.auth.getUser();
    if (user) {
      document.getElementById("authSection").style.display = "none";
      document.getElementById("appSection").style.display = "block";
      document.getElementById("userInfo").innerText =
        user.email ? user.email : "Guest";
    }
  }

  checkUser();

});
</script>

</body>
</html>