<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Public Social Website</title>

<style>
body{
  font-family: Arial;
  padding:20px;
  background:#f2f2f2;
}

.post{
  background:white;
  padding:10px;
  margin-top:10px;
  border-radius:8px;
}
</style>
</head>

<body>

<h2>üåç Public Social Website</h2>

<input id="postInput" placeholder="Write something...">
<button id="postBtn">Post</button>

<div id="feed"></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>

document.addEventListener("DOMContentLoaded", function(){

  const supabase = window.supabase.createClient(
    "https://dgehzagvyrxbnnvgsiff.supabase.co",
    "sb_publishable_0zcUZcMnYsVKrX0rhxA9Eg_6GwlyzKW"
  );

  const postBtn = document.getElementById("postBtn");
  const postInput = document.getElementById("postInput");
  const feed = document.getElementById("feed");

  postBtn.addEventListener("click", async function(){

    const text = postInput.value;

    if(text.trim()===""){
      alert("Write something first");
      return;
    }

    const { error } = await supabase
      .from("posts")
      .insert([{ content:text }]);

    if(error){
      alert(error.message);
    } else {
      postInput.value="";
      loadPosts();
    }

  });

  async function loadPosts(){

    const { data, error } = await supabase
      .from("posts")
      .select("*")
      .order("id",{ascending:false});

    if(error){
      console.log(error);
      return;
    }

    feed.innerHTML="";

    data.forEach(p=>{
      const div=document.createElement("div");
      div.className="post";
      div.innerText=p.content;
      feed.appendChild(div);
    });
  }

  loadPosts();

});

</script>

</body>
</html>
